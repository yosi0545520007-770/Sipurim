{"version":3,"file":"TimedEvent.js","sources":["../../../src/TimedEvent.ts"],"sourcesContent":["import {HDate, Locale} from '@hebcal/hdate';\nimport {CalOptions} from './CalOptions';\nimport {Location} from './location';\nimport {Event} from './event';\nimport {reformatTimeStr} from './reformatTimeStr';\nimport {Zmanim} from './zmanim';\nimport './locale'; // Adds Hebrew and Ashkenazic translations\n\n/** An event that has an `eventTime` and `eventTimeStr` */\nexport class TimedEvent extends Event {\n  readonly eventTime: Date;\n  readonly location: Location;\n  readonly eventTimeStr: string;\n  readonly fmtTime: string;\n  readonly linkedEvent?: Event;\n  /**\n   * @param desc Description (not translated)\n   */\n  constructor(\n    date: HDate,\n    desc: string,\n    mask: number,\n    eventTime: Date,\n    location: Location,\n    linkedEvent?: Event,\n    options?: CalOptions\n  ) {\n    super(date, desc, mask);\n    this.eventTime = Zmanim.roundTime(eventTime);\n    this.location = location;\n    const timeFormat = location.getTimeFormatter();\n    this.eventTimeStr = Zmanim.formatTime(this.eventTime, timeFormat);\n    const opts = {...options, location};\n    this.fmtTime = reformatTimeStr(this.eventTimeStr, 'pm', opts);\n    if (typeof linkedEvent !== 'undefined') {\n      this.linkedEvent = linkedEvent;\n    }\n  }\n  /**\n   * @param [locale] Optional locale name (defaults to active locale).\n   */\n  render(locale?: string): string {\n    return Locale.gettext(this.getDesc(), locale) + ': ' + this.fmtTime;\n  }\n  /**\n   * Returns translation of \"Candle lighting\" without the time.\n   * @param [locale] Optional locale name (defaults to active locale).\n   */\n  renderBrief(locale?: string): string {\n    return Locale.gettext(this.getDesc(), locale);\n  }\n\n  getCategories(): string[] {\n    const desc = this.getDesc();\n    switch (desc) {\n      // LIGHT_CANDLES or LIGHT_CANDLES_TZEIS\n      case 'Candle lighting':\n        return ['candles'];\n      // YOM_TOV_ENDS\n      case 'Havdalah':\n        return ['havdalah'];\n      // flags.MINOR_FAST or flags.MAJOR_FAST\n      case 'Fast begins':\n      case 'Fast ends':\n        return ['zmanim', 'fast'];\n    }\n    /* NOTREACHED */\n    return ['unknown'];\n  }\n}\n\n/** Candle lighting before Shabbat or holiday */\nexport class CandleLightingEvent extends TimedEvent {\n  constructor(\n    date: HDate,\n    mask: number,\n    eventTime: Date,\n    location: Location,\n    linkedEvent?: Event,\n    options?: CalOptions\n  ) {\n    super(\n      date,\n      'Candle lighting',\n      mask,\n      eventTime,\n      location,\n      linkedEvent,\n      options\n    );\n  }\n\n  getEmoji(): string {\n    return 'üïØÔ∏è';\n  }\n}\n\n/** Havdalah after Shabbat or holiday */\nexport class HavdalahEvent extends TimedEvent {\n  private readonly havdalahMins?: number;\n  constructor(\n    date: HDate,\n    mask: number,\n    eventTime: Date,\n    location: Location,\n    havdalahMins?: number,\n    linkedEvent?: Event,\n    options?: CalOptions\n  ) {\n    super(date, 'Havdalah', mask, eventTime, location, linkedEvent, options);\n    if (havdalahMins) {\n      this.havdalahMins = havdalahMins;\n    }\n  }\n  /**\n   * @param [locale] Optional locale name (defaults to active locale).\n   */\n  render(locale?: string): string {\n    return this.renderBrief(locale) + ': ' + this.fmtTime;\n  }\n  /**\n   * Returns translation of \"Havdalah\" without the time.\n   * @param [locale] Optional locale name (defaults to active locale).\n   */\n  renderBrief(locale?: string): string {\n    let str = Locale.gettext(this.getDesc(), locale);\n    if (this.havdalahMins) {\n      const min = Locale.gettext('min', locale);\n      str += ` (${this.havdalahMins} ${min})`;\n    }\n    return str;\n  }\n\n  getEmoji(): string {\n    return '‚ú®';\n  }\n}\n"],"names":[],"mappings":";;;;;;;AAQA;AACM,MAAO,UAAW,SAAQ,KAAK,CAAA;AAMnC;;AAEG;AACH,IAAA,WAAA,CACE,IAAW,EACX,IAAY,EACZ,IAAY,EACZ,SAAe,EACf,QAAkB,EAClB,WAAmB,EACnB,OAAoB,EAAA;AAEpB,QAAA,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;QACvB,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC;AAC5C,QAAA,IAAI,CAAC,QAAQ,GAAG,QAAQ;AACxB,QAAA,MAAM,UAAU,GAAG,QAAQ,CAAC,gBAAgB,EAAE;AAC9C,QAAA,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,CAAC;AACjE,QAAA,MAAM,IAAI,GAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAO,OAAO,CAAA,EAAA,EAAE,QAAQ,GAAC;AACnC,QAAA,IAAI,CAAC,OAAO,GAAG,eAAe,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,EAAE,IAAI,CAAC;AAC7D,QAAA,IAAI,OAAO,WAAW,KAAK,WAAW,EAAE;AACtC,YAAA,IAAI,CAAC,WAAW,GAAG,WAAW;QAChC;IACF;AACA;;AAEG;AACH,IAAA,MAAM,CAAC,MAAe,EAAA;AACpB,QAAA,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,OAAO;IACrE;AACA;;;AAGG;AACH,IAAA,WAAW,CAAC,MAAe,EAAA;QACzB,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC;IAC/C;IAEA,aAAa,GAAA;AACX,QAAA,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE;QAC3B,QAAQ,IAAI;;AAEV,YAAA,KAAK,iBAAiB;gBACpB,OAAO,CAAC,SAAS,CAAC;;AAEpB,YAAA,KAAK,UAAU;gBACb,OAAO,CAAC,UAAU,CAAC;;AAErB,YAAA,KAAK,aAAa;AAClB,YAAA,KAAK,WAAW;AACd,gBAAA,OAAO,CAAC,QAAQ,EAAE,MAAM,CAAC;;;QAG7B,OAAO,CAAC,SAAS,CAAC;IACpB;AACD;AAED;AACM,MAAO,mBAAoB,SAAQ,UAAU,CAAA;IACjD,WAAA,CACE,IAAW,EACX,IAAY,EACZ,SAAe,EACf,QAAkB,EAClB,WAAmB,EACnB,OAAoB,EAAA;AAEpB,QAAA,KAAK,CACH,IAAI,EACJ,iBAAiB,EACjB,IAAI,EACJ,SAAS,EACT,QAAQ,EACR,WAAW,EACX,OAAO,CACR;IACH;IAEA,QAAQ,GAAA;AACN,QAAA,OAAO,KAAK;IACd;AACD;AAED;AACM,MAAO,aAAc,SAAQ,UAAU,CAAA;AAE3C,IAAA,WAAA,CACE,IAAW,EACX,IAAY,EACZ,SAAe,EACf,QAAkB,EAClB,YAAqB,EACrB,WAAmB,EACnB,OAAoB,EAAA;AAEpB,QAAA,KAAK,CAAC,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,EAAE,OAAO,CAAC;QACxE,IAAI,YAAY,EAAE;AAChB,YAAA,IAAI,CAAC,YAAY,GAAG,YAAY;QAClC;IACF;AACA;;AAEG;AACH,IAAA,MAAM,CAAC,MAAe,EAAA;AACpB,QAAA,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,OAAO;IACvD;AACA;;;AAGG;AACH,IAAA,WAAW,CAAC,MAAe,EAAA;AACzB,QAAA,IAAI,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC;AAChD,QAAA,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,MAAM,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC;YACzC,GAAG,IAAI,KAAK,IAAI,CAAC,YAAY,CAAA,CAAA,EAAI,GAAG,GAAG;QACzC;AACA,QAAA,OAAO,GAAG;IACZ;IAEA,QAAQ,GAAA;AACN,QAAA,OAAO,GAAG;IACZ;AACD;;;;"}
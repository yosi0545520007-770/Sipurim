{"version":3,"file":"hebcal.js","sources":["../../../src/hebcal.ts"],"sourcesContent":["/*\n    Hebcal - A Jewish Calendar Generator\n    Copyright (c) 1994-2020 Danny Sadinoff\n    Portions copyright Eyal Schachter and Michael J. Radwin\n\n    https://github.com/hebcal/hebcal-es6\n\n    This program is free software; you can redistribute it and/or\n    modify it under the terms of the GNU General Public License\n    as published by the Free Software Foundation; either version 2\n    of the License, or (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {getBirthdayHD, getYahrzeitHD, HDate} from '@hebcal/hdate';\nimport './locale'; // Adds Hebrew and Ashkenazic translations\nimport {CalOptions} from './CalOptions';\nimport {version as pkgVersion} from './pkgVersion';\nimport {Event, flags} from './event';\nimport {Sedra, getSedra} from './sedra';\nimport {hallel_} from './hallel';\nimport {\n  getHolidaysForYear_,\n  getHolidaysForYearArray,\n  getHolidaysOnDate,\n  HolidayYearMap,\n} from './holidays';\nimport {HolidayEvent} from './HolidayEvent';\nimport {reformatTimeStr} from './reformatTimeStr';\nimport {TachanunResult, tachanun} from './tachanun';\nimport {calendar} from './calendar';\n\n/**\n * HebrewCalendar is the main interface to the `@hebcal/core` library.\n * This namespace is used to calculate holidays, rosh chodesh, candle lighting & havdalah times,\n * Parashat HaShavua, Daf Yomi, days of the omer, and the molad.\n * Event names can be rendered in several languges using the `locale` option.\n */\nexport class HebrewCalendar {\n  private constructor() {}\n  /**\n   * Calculates holidays and other Hebrew calendar events based on {@link CalOptions}.\n   *\n   * Each holiday is represented by an {@link Event} object which includes a date,\n   * a description, flags and optional attributes.\n   * If given no options, returns holidays for the Diaspora for the current Gregorian year.\n   *\n   * The date range returned by this function can be controlled by:\n   * * `options.year` - Gregorian (e.g. 1993) or Hebrew year (e.g. 5749)\n   * * `options.isHebrewYear` - to interpret `year` as Hebrew year\n   * * `options.numYears` - generate calendar for multiple years (default 1)\n   * * `options.month` - Gregorian or Hebrew month (to filter results to a single month)\n   *\n   * Alternatively, specify start and end days with `Date` or {@link HDate} instances:\n   * * `options.start` - use specific start date (requires `end` date)\n   * * `options.end` - use specific end date (requires `start` date)\n   *\n   * Unless `options.noHolidays == true`, default holidays include:\n   * * Major holidays - Rosh Hashana, Yom Kippur, Pesach, Sukkot, etc.\n   * * Minor holidays - Purim, Chanukah, Tu BiShvat, Lag BaOmer, etc.\n   * * Minor fasts - Ta'anit Esther, Tzom Gedaliah, etc. (unless `options.noMinorFast`)\n   * * Special Shabbatot - Shabbat Shekalim, Zachor, etc. (unless `options.noSpecialShabbat`)\n   * * Modern Holidays - Yom HaShoah, Yom HaAtzma'ut, etc. (unless `options.noModern`)\n   * * Rosh Chodesh (unless `options.noRoshChodesh`)\n   *\n   * Holiday and Torah reading schedules differ between Israel and the Disapora.\n   * Set `options.il=true` to use the Israeli schedule.\n   *\n   * Additional non-default event types can be specified:\n   * * Parashat HaShavua - weekly Torah Reading on Saturdays (`options.sedrot`)\n   * * Counting of the Omer (`options.omer`)\n   * * Shabbat Mevarchim HaChodesh on Saturday before Rosh Chodesh (`options.shabbatMevarchim`)\n   * * Molad announcement on Saturday before Rosh Chodesh (`options.molad`)\n   * * Yom Kippur Katan (`options.yomKippurKatan`)\n   * * Yizkor (`options.yizkor`)\n   *\n   * Daily Study of texts are supported by the\n   * {@link https://github.com/hebcal/hebcal-learning @hebcal/learning} package,\n   * for example:\n   * * Babylonian Talmud Daf Yomi (`options.dailyLearning.dafYomi`)\n   * * Jerusalem Talmud (Yerushalmi) Yomi (`options.dailyLearning.yerushalmi`)\n   * * Mishna Yomi (`options.dailyLearning.mishnaYomi`)\n   * * Nach Yomi (`options.dailyLearning.nachYomi`)\n   *\n   * Candle-lighting and Havdalah times are approximated using latitude and longitude\n   * specified by the {@link Location} class. The `Location` class contains a small\n   * database of cities with their associated geographic information and time-zone information.\n   * If you ever have any doubts about Hebcal's times, consult your local halachic authority.\n   * If you enter geographic coordinates above the arctic circle or antarctic circle,\n   * the times are guaranteed to be wrong.\n   *\n   * To add candle-lighting options, set `options.candlelighting=true` and set\n   * `options.location` to an instance of `Location`. By default, candle lighting\n   * time is 18 minutes before sundown (40 minutes for Jerusalem,\n   * 30 minutes for Haifa and Zikhron Ya'akov) and Havdalah is\n   * calculated according to Tzeit Hakochavim - Nightfall (the point when 3 small stars\n   * are observable in the night time sky with the naked eye). The default Havdalah\n   * option (Tzeit Hakochavim) is calculated when the sun is 8.5° below the horizon.\n   * These defaults can be changed using these options:\n   * * `options.candleLightingMins` - minutes before sundown to light candles\n   * * `options.havdalahMins` - minutes after sundown for Havdalah (typical values are 42, 50, or 72).\n   *    Havdalah times are suppressed when `options.havdalahMins=0`.\n   * * `options.havdalahDeg` - degrees for solar depression for Havdalah.\n   *    Default is 8.5 degrees for 3 small stars. Use 7.083 degrees for 3 medium-sized stars.\n   *    Havdalah times are suppressed when `options.havdalahDeg=0`.\n   *\n   * If both `options.candlelighting=true` and `options.location` is specified,\n   * Chanukah candle-lighting times and minor fast start/end times will also be generated.\n   * Chanukah candle-lighting is at Bein HaShmashos (13.5 minutes before\n   * the sun is 7.083° below the horizon in the evening)\n   * on weekdays, at regular candle-lighting time on Fridays, and at regular Havdalah time on\n   * Saturday night (see above).\n   *\n   * Minor fasts begin at Alot HaShachar (sun is 16.1° below the horizon in the morning) and\n   * end when 3 medium-sized stars are observable in the night sky (sun is 7.083° below the horizon\n   * in the evening).\n   *\n   * Two options also exist for generating an Event with the Hebrew date:\n   * * `options.addHebrewDates` - print the Hebrew date for the entire date range\n   * * `options.addHebrewDatesForEvents` - print the Hebrew date for dates with some events\n   *\n   * Lastly, translation and transliteration of event titles is controlled by\n   * `options.locale` and the {@link Locale} API.\n   * `@hebcal/core` supports three locales by default:\n   * * `en` - default, Sephardic transliterations (e.g. \"Shabbat\")\n   * * `ashkenazi` - Ashkenazi transliterations (e.g. \"Shabbos\")\n   * * `he` - Hebrew (e.g. \"שַׁבָּת\")\n   *\n   * Additional locales (such as `ru` or `fr`) are supported by the\n   * {@link https://github.com/hebcal/hebcal-locales @hebcal/locales} package\n   *\n   * @example\n   * import {HebrewCalendar, HDate, Location, Event} from '@hebcal/core';\n   * const options: CalOptions = {\n   *   year: 1981,\n   *   isHebrewYear: false,\n   *   candlelighting: true,\n   *   location: Location.lookup('San Francisco'),\n   *   sedrot: true,\n   *   omer: true,\n   * };\n   * const events = HebrewCalendar.calendar(options);\n   * for (const ev of events) {\n   *   const hd = ev.getDate();\n   *   const date = hd.greg();\n   *   console.log(date.toLocaleDateString(), ev.render('en'), hd.toString());\n   * }\n   */\n  static calendar(options: CalOptions = {}): Event[] {\n    return calendar(options);\n  }\n\n  /**\n   * Calculates a birthday or anniversary (non-yahrzeit).\n   * `hyear` must be after original `gdate` of anniversary.\n   * Returns `undefined` when requested year preceeds or is same as original year.\n   *\n   * Hebcal uses the algorithm defined in \"Calendrical Calculations\"\n   * by Edward M. Reingold and Nachum Dershowitz.\n   *\n   * The birthday of someone born in Adar of an ordinary year or Adar II of\n   * a leap year is also always in the last month of the year, be that Adar\n   * or Adar II. The birthday in an ordinary year of someone born during the\n   * first 29 days of Adar I in a leap year is on the corresponding day of Adar;\n   * in a leap year, the birthday occurs in Adar I, as expected.\n   *\n   * Someone born on the thirtieth day of Marcheshvan, Kislev, or Adar I\n   * has his birthday postponed until the first of the following month in\n   * years where that day does not occur. [Calendrical Calculations p. 111]\n   * @example\n   * import {HebrewCalendar} from '@hebcal/core';\n   * const dt = new Date(2014, 2, 2); // '2014-03-02' == '30 Adar I 5774'\n   * const hd = HebrewCalendar.getBirthdayOrAnniversary(5780, dt); // '1 Nisan 5780'\n   * console.log(hd.greg().toLocaleDateString('en-US')); // '3/26/2020'\n   * @param hyear Hebrew year\n   * @param gdate Gregorian or Hebrew date of event\n   * @returns anniversary occurring in `hyear`\n   */\n  static getBirthdayOrAnniversary(\n    hyear: number,\n    gdate: Date | HDate\n  ): HDate | undefined {\n    const dt = getBirthdayHD(hyear, gdate);\n    if (typeof dt === 'undefined') {\n      return dt;\n    }\n    return new HDate(dt);\n  }\n\n  /**\n   * Calculates yahrzeit.\n   * `hyear` must be after original `gdate` of death.\n   * Returns `undefined` when requested year preceeds or is same as original year.\n   *\n   * Hebcal uses the algorithm defined in \"Calendrical Calculations\"\n   * by Edward M. Reingold and Nachum Dershowitz.\n   *\n   * The customary anniversary date of a death is more complicated and depends\n   * also on the character of the year in which the first anniversary occurs.\n   * There are several cases:\n   *\n   * * If the date of death is Marcheshvan 30, the anniversary in general depends\n   *   on the first anniversary; if that first anniversary was not Marcheshvan 30,\n   *   use the day before Kislev 1.\n   * * If the date of death is Kislev 30, the anniversary in general again depends\n   *   on the first anniversary — if that was not Kislev 30, use the day before\n   *   Tevet 1.\n   * * If the date of death is Adar II, the anniversary is the same day in the\n   *   last month of the Hebrew year (Adar or Adar II).\n   * * If the date of death is Adar I 30, the anniversary in a Hebrew year that\n   *   is not a leap year (in which Adar only has 29 days) is the last day in\n   *   Shevat.\n   * * In all other cases, use the normal (that is, same month number) anniversary\n   *   of the date of death. [Calendrical Calculations p. 113]\n   * @example\n   * import {HebrewCalendar} from '@hebcal/core';\n   * const dt = new Date(2014, 2, 2); // '2014-03-02' == '30 Adar I 5774'\n   * const hd = HebrewCalendar.getYahrzeit(5780, dt); // '30 Sh\\'vat 5780'\n   * console.log(hd.greg().toLocaleDateString('en-US')); // '2/25/2020'\n   * @param hyear Hebrew year\n   * @param gdate Gregorian or Hebrew date of death\n   * @returns anniversary occurring in hyear\n   */\n  static getYahrzeit(hyear: number, gdate: Date | HDate): HDate | undefined {\n    const dt = getYahrzeitHD(hyear, gdate);\n    if (typeof dt === 'undefined') {\n      return dt;\n    }\n    return new HDate(dt);\n  }\n\n  /**\n   * Lower-level holidays interface, which returns a `Map` of `Event`s indexed by\n   * `HDate.toString()`. These events must filtered especially for `flags.IL_ONLY`\n   * or `flags.CHUL_ONLY` depending on Israel vs. Diaspora holiday scheme.\n   * @param year Hebrew year\n   */\n  static getHolidaysForYear(year: number): HolidayYearMap {\n    return getHolidaysForYear_(year);\n  }\n\n  /**\n   * Returns an array of holidays for the year\n   * @param year Hebrew year\n   * @param il use the Israeli schedule for holidays\n   */\n  static getHolidaysForYearArray(year: number, il: boolean): HolidayEvent[] {\n    return getHolidaysForYearArray(year, il);\n  }\n\n  /**\n   * Returns an array of Events on this date (or `undefined` if no events)\n   * @param date Hebrew Date, Gregorian date, or absolute R.D. day number\n   * @param [il] use the Israeli schedule for holidays\n   */\n  static getHolidaysOnDate(\n    date: HDate | Date | number,\n    il?: boolean\n  ): HolidayEvent[] | undefined {\n    return getHolidaysOnDate(date, il);\n  }\n\n  /**\n   * Eruv Tavshilin\n   */\n  static eruvTavshilin(date: Date | HDate, il: boolean): boolean {\n    if (date.getDay() < 3 || date.getDay() > 4) {\n      return false;\n    }\n    const today = new HDate(date);\n    const friday = today.after(5);\n    const tomorrow = today.next();\n    if (!isChag(friday, il) || isChag(today, il) || !isChag(tomorrow, il)) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Helper function to format a 23-hour (00:00-23:59) time in US format (\"8:13pm\") or\n   * keep as \"20:13\" for any other locale/country. Uses {@link CalOptions} to determine\n   * locale.\n   * If `options.hour12` is `false`, locale is ignored and always returns 24-hour time.\n   * If `options.hour12` is `true`, locale is ignored and always returns 12-hour time.\n   * @param timeStr - original time like \"20:30\"\n   * @param suffix - \"p\" or \"pm\" or \" P.M.\". Add leading space if you want it\n   * @param options\n   */\n  static reformatTimeStr(\n    timeStr: string,\n    suffix: string,\n    options: CalOptions\n  ): string {\n    return reformatTimeStr(timeStr, suffix, options);\n  }\n\n  static version(): string {\n    return pkgVersion;\n  }\n\n  /**\n   * Convenience function to create an instance of `Sedra` or reuse a previously\n   * created and cached instance.\n   */\n  static getSedra(hyear: number, il: boolean): Sedra {\n    return getSedra(hyear, il);\n  }\n\n  /**\n   * Return a number containing information on what Hallel is said on that day.\n   *\n   * Whole Hallel is said on Chanukah, the first Yom Tov of Pesach, Shavuot, Sukkot,\n   * Yom Ha'atzmaut, and Yom Yerushalayim.\n   *\n   * Half Hallel is said on Rosh Chodesh (not Rosh Hashanah), and the last 6 days of Pesach.\n   *\n   * The number is one of the following values:\n   *\n   * 0 - No Hallel\n   * 1 - Half Hallel\n   * 2 - Whole Hallel\n   */\n  static hallel(hdate: HDate, il: boolean): number {\n    const events = getHolidaysForYearArray(hdate.getFullYear(), il);\n    return hallel_(events, hdate);\n  }\n\n  /**\n   * Return details on what Tachanun (or Tzidchatcha on Shabbat) is said on `hdate`.\n   *\n   * Tachanun is not said on Rosh Chodesh, the month of Nisan, Lag Baomer,\n   * Rosh Chodesh Sivan until Isru Chag, Tisha B'av, 15 Av, Erev Rosh Hashanah,\n   * Rosh Hashanah, Erev Yom Kippur until after Simchat Torah, Chanukah,\n   * Tu B'shvat, Purim and Shushan Purim, and Purim and Shushan Purim Katan.\n   *\n   * In some congregations Tachanun is not said until from Rosh Chodesh Sivan\n   * until 14th Sivan, Sukkot until after Rosh Chodesh Cheshvan, Pesach Sheini,\n   * Yom Ha'atzmaut, and Yom Yerushalayim.\n   *\n   * Tachanun is not said at Mincha on days before it is not said at Shacharit.\n   *\n   * Tachanun is not said at Shacharit on Shabbat, but is at Mincha, usually.\n   */\n  static tachanun(hdate: HDate, il: boolean): TachanunResult {\n    return tachanun(hdate, il);\n  }\n}\n\n/**\n * @private\n */\nfunction isChag(date: HDate, il: boolean): boolean {\n  const events = getHolidaysOnDate(date, il) || [];\n  const chag = events.filter(ev => ev.getFlags() & flags.CHAG);\n  return chag.length !== 0;\n}\n"],"names":["pkgVersion"],"mappings":"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"}
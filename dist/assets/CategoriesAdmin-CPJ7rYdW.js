import{r as a,j as e,s as l}from"./index-DhAAA4kQ.js";function S(){const[o,b]=a.useState([]),[j,m]=a.useState(!0),[u,n]=a.useState(null),[x,g]=a.useState(null),[N,r]=a.useState(!1),[i,f]=a.useState(null),[p,d]=a.useState("");async function c(){try{m(!0),n(null);const{data:s,error:t}=await l.from("categories").select("id, name, created_at").order("name",{ascending:!0});if(t)throw t;b(s||[])}catch(s){n(s.message||"שגיאה בטעינת הקטגוריות")}finally{m(!1)}}a.useEffect(()=>{c()},[]);function y(){f(null),d(""),r(!0)}function w(s){f(s.id),d(s.name),r(!0)}async function v(){const s=p.trim();if(!s){n("שם הקטגוריה הוא שדה חובה");return}try{n(null);const t={name:s},{error:h}=i?await l.from("categories").update(t).eq("id",i):await l.from("categories").insert(t);if(h)throw h;g("הקטגוריה נשמרה בהצלחה"),r(!1),await c()}catch(t){n(t.message||"שגיאה בשמירת הקטגוריה")}}async function C(s){if(confirm("האם למחוק את הקטגוריה?"))try{n(null),await l.from("categories").delete().eq("id",s),g("הקטגוריה נמחקה בהצלחה"),await c()}catch(t){n(t.message||"שגיאה במחיקת הקטגוריה")}}return e.jsxs("section",{className:"p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"ניהול קטגוריות"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-xl",onClick:y,children:"+ קטגוריה חדשה"})]}),u&&e.jsx("div",{className:"rounded-lg bg-red-50 text-red-700 p-3",children:u}),x&&e.jsx("div",{className:"rounded-lg bg-green-50 text-green-700 p-3",children:x}),j?e.jsx("div",{children:"טוען רשימת קטגוריות..."}):e.jsxs("div",{className:"max-w-md rounded-2xl border bg-white",children:[o.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border-b last:border-b-0",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 rounded-lg border text-sm",onClick:()=>w(s),children:"עריכה"}),e.jsx("button",{className:"px-3 py-1 rounded-lg border border-red-300 text-red-600 text-sm",onClick:()=>C(s.id),children:"מחיקה"})]})]},s.id)),o.length===0&&e.jsx("div",{className:"p-3 text-gray-500",children:"לא נמצאו קטגוריות."})]}),N&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 grid place-items-center p-4",onClick:()=>r(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:i?"עריכת קטגוריה":"קטגוריה חדשה"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"שם הקטגוריה *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2",value:p,onChange:s=>d(s.target.value)})]}),e.jsxs("div",{className:"flex gap-2 mt-6 justify-end",children:[e.jsx("button",{className:"bg-gray-200 px-4 py-2 rounded-lg",onClick:()=>r(!1),children:"ביטול"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg",onClick:v,children:"שמירה"})]})]})})]})}export{S as Component};

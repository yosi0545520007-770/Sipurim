import{r,j as e,s as d}from"./index-B54MtHlO.js";function _(){const[o,b]=r.useState([]),[x,m]=r.useState(!0),[h,a]=r.useState(null),[p,g]=r.useState(null),[j,l]=r.useState(!1),[c,f]=r.useState(null),[t,i]=r.useState({question:"",answer:"",is_published:!0,sort_order:0});async function u(){try{m(!0),a(null);const{data:s,error:n}=await d.from("faq").select("id, question, answer, is_published, sort_order").order("sort_order",{ascending:!0});if(n)throw n;b(s||[])}catch(s){a(s.message||"שגיאה בטעינת שאלות נפוצות")}finally{m(!1)}}r.useEffect(()=>{u()},[]);function w(){f(null),i({question:"",answer:"",is_published:!0,sort_order:o.length+1}),l(!0)}function N(s){f(s.id),i({question:s.question,answer:s.answer,is_published:s.is_published,sort_order:s.sort_order}),l(!0)}async function y(){if(!t.question.trim()||!t.answer.trim()){a("יש למלא שאלה ותשובה.");return}try{a(null);const s={...t,question:t.question.trim(),answer:t.answer.trim()},{error:n}=c?await d.from("faq").update(s).eq("id",c):await d.from("faq").insert(s);if(n)throw n;g("הפריט נשמר בהצלחה"),l(!1),await u()}catch(s){a(s.message||"שגיאה בשמירת הפריט")}}async function v(s){if(confirm("האם למחוק שאלה זו?"))try{a(null),await d.from("faq").delete().eq("id",s),g("השאלה נמחקה בהצלחה"),await u()}catch(n){a(n.message||"שגיאה במחיקת השאלה")}}return e.jsxs("section",{className:"p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"ניהול שאלות נפוצות"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-xl",onClick:w,children:"+ שאלה חדשה"})]}),h&&e.jsx("div",{className:"rounded-lg bg-red-50 text-red-700 p-3",children:h}),p&&e.jsx("div",{className:"rounded-lg bg-green-50 text-green-700 p-3",children:p}),x&&e.jsx("div",{children:"טוען..."}),!x&&e.jsxs("div",{className:"divide-y rounded-2xl border bg-white",children:[o.map(s=>e.jsxs("div",{className:"p-3 flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:s.question}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 rounded-lg border text-sm",onClick:()=>N(s),children:"עריכה"}),e.jsx("button",{className:"px-3 py-1 rounded-lg border border-red-300 text-red-600 text-sm",onClick:()=>v(s.id),children:"מחיקה"})]})]},s.id)),o.length===0&&e.jsx("div",{className:"p-4 text-gray-500",children:"אין שאלות להצגה."})]}),j&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 grid place-items-center p-4",onClick:()=>l(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl p-6",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:c?"עריכת שאלה":"שאלה חדשה"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"שאלה *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2",value:t.question,onChange:s=>i({...t,question:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"תשובה *"}),e.jsx("textarea",{className:"w-full mt-1 border rounded-lg p-2 min-h-[150px]",value:t.answer,onChange:s=>i({...t,answer:s.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_published",checked:t.is_published,onChange:s=>i({...t,is_published:s.target.checked})}),e.jsx("label",{htmlFor:"is_published",className:"text-sm",children:"מפורסם?"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6 justify-end",children:[e.jsx("button",{className:"bg-gray-200 px-4 py-2 rounded-lg",onClick:()=>l(!1),children:"ביטול"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg",onClick:y,children:"שמירה"})]})]})})]})}export{_ as Component};
